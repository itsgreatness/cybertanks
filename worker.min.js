const{sin:s,cos:o,PI:t,sqrt:a,atan2:p}=Math,e=(s,o,t,p)=>a((p-o)*(p-o)+(t-s)*(t-s)),n=(s,o,a,e)=>p(e-o,a-s)+(e<o?t:0);onmessage=function(a){const p=a.data[0],r=a.data[1],i=.08*a.data[2],l=r[0].pos[0],c=r[0].pos[2],h=r.filter(((s,o)=>s.pos&&s.health<1/0&&!s.isPlane&&s.vel[1]>-1&&o>0)).sort(((s,o)=>e(l,s.pos[0],c,s.pos[2])-e(l,o.pos[0],c,o.pos[2])));for(let a=0;a<p;a++){const p=h.at(a);this.postMessage({pos:[p.pos[0]+i*s(p.rot+t),p.pos[1],p.pos[2]+i*o(p.rot+t)],rot:n(l,c,p.pos[0],p.pos[2])}),this.postMessage({bullets:!0});const e=Date.now();for(;Date.now()-e<1e3;)this.postMessage({rot:n(l,c,p.pos[0],p.pos[2])})}};